{%- comment -%}
  Collection template styled with TailwindCSS utility classes.
  Assumes Tailwind is already loaded in your theme (theme.liquid).
{%- endcomment -%}

<section class='bg-white text-neutral-900'>
  <div class='container-custom pt-[10rem] pb-[10rem]'>
    {%- comment -%} Top: title + hero image {%- endcomment -%}
    <div class='flex flex-col items-start justify-between gap-10 lg:flex-row lg:items-start'>
      <!--
        <div class='pt-2'>
          <h1 class='text-4xl font-medium tracking-tight'>
            {{ collection.title }}
          </h1>
        </div>
      -->

      <div class='w-full'>
        <div class='mx-auto flex items-center justify-center bg-neutral-100'>
          {%- comment -%}
            Uses collection.image if present. Falls back to first product image.
          {%- endcomment -%}
          {%- if collection.image -%}
            <img
              src='{{ collection.image | image_url: width: 900 }}'
              alt='{{ collection.image.alt | escape | default: collection.title }}'
              class='h-[190px] w-auto object-contain py-4 opacity-90'
              loading='eager'
            >
          {%- elsif collection.products_count > 0 and collection.products.first.featured_image -%}
            <img
              src='{{ collection.products.first.featured_image | image_url: width: 900 }}'
              alt='{{ collection.title | escape }}'
              class='h-[190px] w-auto object-contain py-4 opacity-90'
              loading='eager'
            >
          {%- else -%}
            <div class='h-[190px] w-full'></div>
          {%- endif -%}
        </div>
      </div>
    </div>

    {%- comment -%} Products + sorting/filter bar {%- endcomment -%}
    {%- paginate collection.products by section.settings.products_per_page -%}
      <div class='mt-12 flex items-end justify-between gap-6 flex-col sm:flex-row'>
        <div class='order-2 sm:order-1 text-xs text-neutral-500'>{{ collection.products_count }} products</div>

        <div class='order-1 sm:order-2 flex flex-wrap items-end gap-6'>
          {%- comment -%}
            Filter UI placeholder to match screenshot.
            Hook this into your existing filtering solution if you have one.
            (Dawn uses facets via sections/main-collection-product-grid.liquid)
          {%- endcomment -%}
          <div class='min-w-[220px] w-full sm:w-auto'>
            <label class='block text-[11px] text-neutral-600'>Filter by</label>
            <select
              class='mt-2 w-full rounded-none border border-neutral-300 bg-white px-3 py-2 text-xs text-neutral-800 outline-none focus:border-neutral-500'
              aria-label='Filter by'
              disabled
            >
              <option>All products</option>
            </select>
          </div>

          {%- comment -%} Sort by (native Shopify sorting via query param) {%- endcomment -%}
          <div class='min-w-[220px] w-full sm:w-auto'>
            <label class='block text-[11px] text-neutral-600'>Sort by</label>

            <form method='get' class='mt-2'>
              {%- comment -%}
                Preserve existing params except sort_by
              {%- endcomment -%}
              {%- for param in request.query_parameters -%}
                {%- unless param[0] == 'sort_by' -%}
                  <input type='hidden' name='{{ param[0] }}' value='{{ param[1] | escape }}'>
                {%- endunless -%}
              {%- endfor -%}

              <select
                name='sort_by'
                class='w-full rounded-none border border-neutral-300 bg-white px-3 py-2 text-xs text-neutral-800 outline-none focus:border-neutral-500'
                onchange='this.form.submit()'
                aria-label='Sort by'
              >
                {%- assign current_sort = collection.sort_by | default: collection.default_sort_by -%}

                {%- for option in collection.sort_options -%}
                  <option
                    value='{{ option.value }}'
                    {% if option.value == current_sort %}
                      selected
                    {% endif %}
                  >
                    {{ option.name }}
                  </option>
                {%- endfor -%}
              </select>

              <noscript>
                <button
                  type='submit'
                  class='mt-2 border border-neutral-300 px-3 py-2 text-xs'
                >
                  Apply
                </button>
              </noscript>
            </form>
          </div>
        </div>
      </div>

      {%- comment -%} Product grid {%- endcomment -%}
      <div class='mt-10 grid grid-cols-2 gap-x-10 gap-y-12 lg:grid-cols-4'>
        {%- for product in collection.products -%}
          <a href='{{ product.url }}' class='group block'>
            <div class='aspect-square w-full bg-neutral-100 p-6'>
              {%- if product.featured_image -%}
                <img
                  src='{{ product.featured_image | image_url: width: 720 }}'
                  alt='{{ product.featured_image.alt | escape | default: product.title }}'
                  class='h-full w-full object-contain'
                  loading='lazy'
                >
              {%- endif -%}
            </div>

            <div class='mt-3 text-xs text-neutral-900'>
              {{ product.title }}
            </div>

            <div class='mt-1 text-xs font-medium'>
              {%- if product.compare_at_price_max > product.price -%}
                <span class='text-neutral-500 line-through'>
                  {{ product.compare_at_price_max | money }}
                </span>
                <span class='ml-2'>
                  {{ product.price | money }}
                </span>
              {%- else -%}
                {{ product.price | money }}
              {%- endif -%}
            </div>
          </a>
        {%- endfor -%}
      </div>

      {%- comment -%} Pagination (1 2 >) {%- endcomment -%}
      {%- if paginate.pages > 1 -%}
        <div class='mt-12 flex items-center justify-center gap-4 text-sm'>
          {%- if paginate.previous -%}
            <a
              class='px-2 py-1 text-neutral-600 hover:text-neutral-900'
              href='{{ paginate.previous.url }}'
              aria-label='Previous page'
            >
              ‹
            </a>
          {%- endif -%}

          {%- for part in paginate.parts -%}
            {%- if part.is_link -%}
              <a class='px-2 py-1 text-neutral-600 hover:text-neutral-900' href='{{ part.url }}'>
                {{ part.title }}
              </a>
            {%- else -%}
              <span class='px-2 py-1 {% if part.title == paginate.current_page %}border-b border-neutral-900 text-neutral-900{% else %}text-neutral-400{% endif %}'>
                {{ part.title }}
              </span>
            {%- endif -%}
          {%- endfor -%}

          {%- if paginate.next -%}
            <a
              class='px-2 py-1 text-neutral-600 hover:text-neutral-900'
              href='{{ paginate.next.url }}'
              aria-label='Next page'
            >
              ›
            </a>
          {%- endif -%}
        </div>
      {%- endif -%}
    {%- endpaginate -%}
  </div>
</section>

{% schema %}
{
  "name": "Collection (Tailwind)",
  "settings": [
    {
      "type": "range",
      "id": "products_per_page",
      "min": 8,
      "max": 48,
      "step": 4,
      "default": 24,
      "label": "Products per page"
    }
  ]
}
{% endschema %}
