<section class='product-tabs w-full h-[100vh] md:h-[75vh] bg-dark text-light'>
  <div class='container-custom mx-auto h-full flex flex-col'>
    <!-- Tab headers -->
    <div class='flex justify-center gap-4 border-b border-gray-700'>
      {% for block in section.blocks %}
        <button
          class='tab-btn py-4 px-6 text-base font-semibold hover:text-primary transition-colors {% if forloop.first %}active text-primary border-b-2 border-primary{% endif %}'
          data-tab='tab-{{ block.id }}'
        >
          {{ block.settings.tab_label }}
        </button>
      {% endfor %}
    </div>

    <!-- Tab panels -->
    <div class='tab-content flex-1 overflow-y-auto p-6'>
      {% for block in section.blocks %}
        <div
          id='tab-{{ block.id }}'
          class='tab-panel {% if forloop.first %}block{% else %}hidden{% endif %}'
        >
          {% if block.type == 'testimonials' %}
            <h3 class='text-2xl font-bold mb-6'>{{ block.settings.heading }}</h3>
            <div class='grid grid-cols-1 md:grid-cols-3 gap-6'>
              {% for testimonial in block.blocks %}
                <div class='p-6 bg-gray-800 rounded-lg'>
                  <p class='text-light italic mb-4'>"{{ testimonial.settings.quote }}"</p>
                  <p class='text-primary font-semibold'>- {{ testimonial.settings.author }}</p>
                </div>
              {% endfor %}
            </div>

          {% elsif block.type == 'faq' %}
            <h3 class='text-2xl font-bold mb-6'>{{ block.settings.heading }}</h3>
            <div class='space-y-4'>
              {% for faq in block.blocks %}
                <div class='border-b border-gray-700 pb-4'>
                  <h4 class='text-lg font-semibold mb-2'>{{ faq.settings.question }}</h4>
                  <p class='text-light'>{{ faq.settings.answer }}</p>
                </div>
              {% endfor %}
            </div>

          {% else %}
            <!-- If you add a new block type later -->
            <div class='text-center text-light/70'>
              <p>No content configured for this tab yet.</p>
            </div>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Product Tabs",
  "tag": "section",
  "settings": [],
  "blocks": [
    {
      "type": "testimonials",
      "name": "Testimonials Tab",
      "settings": [
        {
          "type": "text",
          "id": "tab_label",
          "label": "Tab Label",
          "default": "Testimonials"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "What Our Customers Say"
        }
      ],
      "blocks": [
        {
          "type": "quote",
          "name": "Testimonial",
          "settings": [
            {
              "type": "text",
              "id": "quote",
              "label": "Quote",
              "default": "This product changed my life!"
            },
            {
              "type": "text",
              "id": "author",
              "label": "Author",
              "default": "John Doe"
            }
          ]
        }
      ],
      "max_blocks": 6
    },
    {
      "type": "faq",
      "name": "FAQ Tab",
      "settings": [
        {
          "type": "text",
          "id": "tab_label",
          "label": "Tab Label",
          "default": "FAQ"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Frequently Asked Questions"
        }
      ],
      "blocks": [
        {
          "type": "faq_item",
          "name": "FAQ Item",
          "settings": [
            {
              "type": "text",
              "id": "question",
              "label": "Question",
              "default": "How soon does it work?"
            },
            {
              "type": "textarea",
              "id": "answer",
              "label": "Answer",
              "default": "Most people feel effects within 30 minutes."
            }
          ]
        }
      ],
      "max_blocks": 10
    }
  ],
  "max_blocks": 3,
  "presets": [
    {
      "name": "Product Tabs",
      "category": "Product",
      "blocks": [
        {
          "type": "testimonials"
        },
        {
          "type": "faq"
        }
      ]
    }
  ]
}
{% endschema %}

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const tabBtns = document.querySelectorAll('.product-tabs .tab-btn');
    const panels = document.querySelectorAll('.product-tabs .tab-panel');

    tabBtns.forEach((btn) => {
      btn.addEventListener('click', () => {
        // reset active state
        tabBtns.forEach((b) => b.classList.remove('active', 'text-primary', 'border-b-2', 'border-primary'));
        panels.forEach((panel) => panel.classList.add('hidden'));

        // activate clicked tab
        btn.classList.add('active', 'text-primary', 'border-b-2', 'border-primary');
        document.getElementById(btn.getAttribute('data-tab')).classList.remove('hidden');
      });
    });
  });
</script>
